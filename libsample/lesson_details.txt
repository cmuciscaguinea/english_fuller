import 'package:flutter/material.dart';
import 'package:audioplayers/audioplayers.dart';
import 'package:google_fonts/google_fonts.dart';

class LessonDetailScreen extends StatelessWidget {
  final int lessonNumber;
  static const String routeName = '/lessonDetail';
  final AudioPlayer audioPlayer = AudioPlayer();

  LessonDetailScreen({Key? key, required this.lessonNumber, required String LessonDetailScreen}) : super(key: key);

  Map<String, dynamic> getLessonDetails(int lessonNumber) {
    var lessonContent = {
      1: {
        'title': 'Lesson $lessonNumber',
        'subTitle': 'Rythme Words',
        'words': ['Bed', 'Red', 'Beg', 'Leg', 'Gem', 'Bem', 'Hen', 'Pen', 'Get', 'Net'],
      },
    };

    return lessonContent[lessonNumber] ?? {
      'title': 'Lesson Not Found',
      'subTitle': '',
      'letters': [],
    };
  }

  void playSound(String word) async {
    try {
      String audioAssetPath = 'assets/word/${word.toLowerCase()}.mp3';
      Source audioSource = DeviceFileSource(audioAssetPath);
      await audioPlayer.play(audioSource);
    } catch (e) {
      print("An error occurred while playing the sound: $e");
    }
  }

  @override
  Widget build(BuildContext context) {
    final lessonDetails = getLessonDetails(lessonNumber);

    return Scaffold(
      appBar: AppBar(
        backgroundColor: Colors.green,
        title: Text(
          lessonDetails['title'],
          style: GoogleFonts.lexendDeca(),
        ),
        leading: IconButton(
          icon: Icon(Icons.arrow_back),
          onPressed: () => Navigator.of(context).pop(),
        ),
      ),
      body: Column(
        crossAxisAlignment: CrossAxisAlignment.center,
        children: [
          Padding(
            padding: const EdgeInsets.symmetric(vertical: 16.0),
            child: Text(
              lessonDetails['subTitle'], // Subtitle content
              style: GoogleFonts.lexendDeca(
                fontSize: 24,
                fontWeight: FontWeight.bold,
              ),
              textAlign: TextAlign.center, // Center-align the text content
            ),
          ),
          Expanded(
            child: GridView.builder(
              padding: const EdgeInsets.all(10),
              gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
                crossAxisCount: 3, // Three columns
                crossAxisSpacing: 10,
                mainAxisSpacing: 10,
              ),
              itemCount: lessonDetails['words'].length,
              itemBuilder: (context, index) {
                final word = lessonDetails['words'][index];
                return Container(
                  padding: EdgeInsets.all(8.0),
                  decoration: BoxDecoration(
                    color: Colors.white,
                    borderRadius: BorderRadius.circular(8),
                    boxShadow: [
                      BoxShadow(
                        color: Colors.grey.withOpacity(0.5),
                        blurRadius: 4,
                        offset: Offset(0, 2),
                      ),
                    ],
                  ),
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Text(
                        word,
                        style: GoogleFonts.lexendDeca(
                          fontSize: 18,
                          fontWeight: FontWeight.bold,
                          color: Colors.black,
                        ),
                      ),
                      IconButton(
                        icon: Icon(
                          Icons.play_circle,
                          color: Colors.green,
                          size: 30,
                        ),
                        onPressed: () {
                          playSound(word);
                        },
                      ),
                    ],
                  ),
                );
              },
            ),
          ),
          Padding(
            padding: const EdgeInsets.symmetric(vertical: 10.0, horizontal: 10.0),
            child: ElevatedButton(
              style: ElevatedButton.styleFrom(
                backgroundColor: Colors.green,
                padding: EdgeInsets.symmetric(vertical: 20, horizontal: 20),
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(10),
                ),
              ),
              onPressed: () {
                // Navigate to the next lesson or show a message
                print("Next Lesson Button Pressed");
              },
              child: Text(
                'Next Lesson',
                style: GoogleFonts.lexendDeca(
                  fontSize: 20,
                  color: Colors.white,
                ),
              ),
            ),
          ),
        ],
      ),
    );
  }
}
